@use '../../components/theme-mixins.scss' as *;

.page-container {
  padding: 0;
  max-width: none;
  margin: 0;
}

.search-container {
  @include themed-card(false);
  min-height: calc(100vh - 120px);
  padding: 0;
  overflow: hidden;

  .search-header {
    background: linear-gradient(135deg, 
      color-mix(in srgb, var(--theme-primary) 8%, var(--theme-surface)),
      color-mix(in srgb, var(--theme-accent) 4%, var(--theme-surface))
    );
    padding: 24px;
    border-bottom: 1px solid color-mix(in srgb, var(--theme-on-surface) 8%, transparent);

    .search-input-container {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;

      .search-field {
        flex: 1;
        
        ::ng-deep {
          .mat-mdc-form-field-outline {
            background: var(--theme-surface);
            border-radius: 12px;
          }
          
          .mat-mdc-form-field-focus-overlay {
            background: color-mix(in srgb, var(--theme-primary) 5%, transparent);
          }
        }
      }

      .search-actions {
        .filter-button {
          @include themed-button('primary');
          
          .mat-icon.has-filters {
            color: var(--theme-accent);
          }
        }
      }
    }

    .active-filters {
      .filter-summary {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 16px;
        background: color-mix(in srgb, var(--theme-primary) 5%, transparent);
        border-radius: 8px;
        border: 1px solid color-mix(in srgb, var(--theme-primary) 20%, transparent);

        .filter-count {
          font-size: 14px;
          color: var(--theme-primary);
          font-weight: 500;
        }

        .reset-filters {
          font-size: 12px;
          min-width: auto;
          padding: 4px 12px;
          
          mat-icon {
            font-size: 16px;
            width: 16px;
            height: 16px;
            margin-right: 4px;
          }
        }
      }
    }
  }

  .search-content {
    padding: 24px;
    min-height: 400px;

    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      
      mat-spinner {
        margin-bottom: 16px;
      }
      
      p {
        color: color-mix(in srgb, var(--theme-on-surface) 70%, transparent);
        margin: 0;
      }
    }

    .suggestions-container {
      h3 {
        color: var(--theme-on-surface);
        margin-bottom: 16px;
        font-weight: 500;
      }

      .suggestions-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;

        .suggestion-chip {
          @include themed-button('outline');
          border-radius: 20px;
          
          mat-icon {
            font-size: 16px;
            width: 16px;
            height: 16px;
            margin-right: 8px;
          }
        }
      }
    }

    .results-container {
      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;

        h3 {
          color: var(--theme-on-surface);
          margin: 0;
          font-weight: 500;
        }
      }

      .results-list {
        display: flex;
        flex-direction: column;
        gap: 12px;

        .result-card {
          @include themed-card(true);
          cursor: pointer;
          transition: all 0.2s ease;

          &:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px color-mix(in srgb, var(--theme-primary) 15%, transparent);
          }

          mat-card-content {
            padding: 16px !important;

            .result-header {
              display: flex;
              align-items: center;
              gap: 16px;

              .result-icon {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 48px;
                height: 48px;
                border-radius: 12px;
                background: color-mix(in srgb, var(--theme-primary) 10%, transparent);

                mat-icon {
                  font-size: 24px;
                  width: 24px;
                  height: 24px;
                  color: var(--theme-primary);
                }
              }

              .result-info {
                flex: 1;

                .result-title {
                  margin: 0 0 4px 0;
                  font-size: 16px;
                  font-weight: 500;
                  color: var(--theme-on-surface);
                }

                .result-subtitle {
                  margin: 0 0 12px 0;
                  font-size: 14px;
                  color: color-mix(in srgb, var(--theme-on-surface) 70%, transparent);
                }

                .result-meta {
                  display: flex;
                  gap: 8px;
                  flex-wrap: wrap;

                  mat-chip {
                    font-size: 11px;
                    height: 24px;
                    
                    &.module-chip {
                      background: color-mix(in srgb, var(--theme-primary) 15%, transparent);
                      color: var(--theme-primary);
                      
                      mat-icon[matChipAvatar] {
                        font-size: 14px;
                        width: 14px;
                        height: 14px;
                      }
                    }

                    &.type-chip {
                      background: color-mix(in srgb, var(--theme-secondary) 15%, transparent);
                      color: var(--theme-secondary);
                    }

                    &.status-chip {
                      &[color="success"] {
                        background: color-mix(in srgb, var(--theme-success) 15%, transparent);
                        color: var(--theme-success);
                      }
                      
                      &[color="warn"] {
                        background: color-mix(in srgb, var(--theme-warning) 15%, transparent);
                        color: var(--theme-warning);
                      }
                      
                      &[color="accent"] {
                        background: color-mix(in srgb, var(--theme-accent) 15%, transparent);
                        color: var(--theme-accent);
                      }
                    }
                  }
                }
              }

              .result-actions {
                .navigate-icon {
                  color: color-mix(in srgb, var(--theme-on-surface) 40%, transparent);
                  font-size: 16px;
                  width: 16px;
                  height: 16px;
                }
              }
            }
          }
        }
      }
    }

    .empty-state, .initial-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;

      .empty-icon, .initial-icon {
        font-size: 64px;
        width: 64px;
        height: 64px;
        color: color-mix(in srgb, var(--theme-on-surface) 30%, transparent);
        margin-bottom: 16px;
      }

      h3 {
        color: var(--theme-on-surface);
        margin-bottom: 8px;
        font-weight: 500;
      }

      p {
        color: color-mix(in srgb, var(--theme-on-surface) 70%, transparent);
        margin-bottom: 24px;
      }

      .search-tips {
        max-width: 400px;
        text-align: left;

        h4 {
          color: var(--theme-on-surface);
          margin-bottom: 12px;
          font-weight: 500;
        }

        ul {
          color: color-mix(in srgb, var(--theme-on-surface) 70%, transparent);
          padding-left: 20px;

          li {
            margin-bottom: 8px;
          }
        }
      }
    }
  }
}

// Module-specific styling
.module-user-management .result-icon mat-icon { color: #2196f3; }
.module-hr-management .result-icon mat-icon { color: #8bc34a; }
.module-projects-management .result-icon mat-icon { color: #9c27b0; }
.module-tasks-management .result-icon mat-icon { color: #f44336; }
.module-crm .result-icon mat-icon { color: #ff5722; }
.module-organization-management .result-icon mat-icon { color: #4caf50; }

// Filters menu styling
::ng-deep .filters-menu {
  .mat-mdc-menu-panel {
    min-width: 400px;
    max-width: 500px;
    max-height: 600px;
    overflow-y: auto;
  }

  .filters-content {
    padding: 0;

    .filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      background: color-mix(in srgb, var(--theme-primary) 5%, transparent);
      border-bottom: 1px solid color-mix(in srgb, var(--theme-on-surface) 8%, transparent);

      h3 {
        margin: 0;
        color: var(--theme-on-surface);
        font-weight: 500;
      }

      .filter-actions {
        display: flex;
        gap: 8px;

        button {
          font-size: 12px;
          min-width: auto;
          padding: 4px 8px;
          
          mat-icon {
            font-size: 16px;
            width: 16px;
            height: 16px;
            margin-right: 4px;
          }
        }
      }
    }

    .filter-section {
      padding: 16px 20px;

      h4 {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--theme-on-surface);
        margin-bottom: 16px;
        font-weight: 500;
        font-size: 14px;

        mat-icon {
          font-size: 18px;
          width: 18px;
          height: 18px;
          color: var(--theme-primary);
        }
      }

      .filter-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;

        .filter-checkbox {
          ::ng-deep .mdc-form-field {
            width: 100%;
          }

          .checkbox-content {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s ease;

            &:hover {
              background: color-mix(in srgb, var(--theme-primary) 5%, transparent);
            }

            .module-icon, .type-icon {
              font-size: 16px;
              width: 16px;
              height: 16px;
            }

            // Module-specific colors
            .module-user-management { color: #2196f3; }
            .module-hr-management { color: #8bc34a; }
            .module-projects-management { color: #9c27b0; }
            .module-tasks-management { color: #f44336; }
            .module-crm { color: #ff5722; }
            .module-organization-management { color: #4caf50; }

            span {
              font-size: 13px;
              color: var(--theme-on-surface);
            }
          }
        }
      }
    }

    .filter-footer {
      padding: 12px 20px;
      border-top: 1px solid color-mix(in srgb, var(--theme-on-surface) 8%, transparent);
      background: color-mix(in srgb, var(--theme-surface) 50%, transparent);

      .reset-button {
        width: 100%;
        justify-content: center;
        
        mat-icon {
          font-size: 16px;
          width: 16px;
          height: 16px;
          margin-right: 8px;
        }
      }
    }
  }
}

// Responsive design
@include mobile {
  .search-container {
    .search-header {
      padding: 16px;

      .search-input-container {
        flex-direction: column;
        gap: 12px;

        .search-field {
          width: 100%;
        }
      }
    }

    .search-content {
      padding: 16px;

      .results-list .result-card {
        mat-card-content .result-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 12px;

          .result-info .result-meta {
            justify-content: flex-start;
          }
        }
      }
    }
  }

  ::ng-deep .filters-menu .mat-mdc-menu-panel {
    min-width: 300px;
    
    .filters-content .filter-section .filter-grid {
      grid-template-columns: 1fr;
    }
  }
}

// Dark theme adjustments
:host-context(body.dark-theme) {
  .search-container .search-header {
    border-bottom-color: color-mix(in srgb, var(--theme-on-surface) 15%, transparent);
  }

  .result-card:hover {
    box-shadow: 0 6px 20px color-mix(in srgb, var(--theme-primary) 25%, transparent);
  }
}